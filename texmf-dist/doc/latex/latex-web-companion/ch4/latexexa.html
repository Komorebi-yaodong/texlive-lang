
    
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> 
<html  
><head><!--latexexa.html from latexexa.tex (TeX4ht, 1999-03-31 09:15:00)--> 
<title>Simulation of Energy Loss Straggling</title><link 
rel="stylesheet" type="text/css" href="latexexa.css"></head><body 
>       <div align="center" class="maketitle">
<h2 class="titleHead">Simulation of Energy Loss Straggling</h2>
<div class="author" align="center"><span 
class="emr-12">Maria Physicist</span></div>
<br>
<div class="date" align="center"><span 
class="emr-12">March 31, 1999</span></div>
   <span class="thanks"></span></div>
   <h2 class="sectionHead">1 <a 
   name="1-10001"></a><a 
   name="QQ1-1-1"></a>Introduction</h2>
<!--16--><p class="noindent">Due to the statistical nature of ionisation energy loss, large fluctuations can occur in
the amount of energy deposited by a particle traversing an absorber element.
Continuous processes such as multiple scattering and energy loss play a
relevant role in the longitudinal and lateral development of electromagnetic and
hadronic showers, and in the case of sampling calorimeters the measured
resolution can be significantly affected by such fluctuations in their active
layers. The description of ionisation fluctuations is characterised by the
significance parameter <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"></span>, which is proportional to the ratio of mean energy loss to
the maximum allowed energy transfer in a single collision with an atomic
electron
   <center>
<img 
src="latexexa0x.gif"alt="     q
k = E----
     max"class="mathdisplay"></center> <span 
class="emmi-10">E</span><span 
class="emr-7">max</span>
is the maximum transferable energy in a single collision with an atomic
electron.
   <center>
<img 
src="latexexa1x.gif"alt="               2m b2g2
Emax = ----------e----------2-,
       1 +2gme/mx  + (me/mx)"class="mathdisplay"></center> where
<span 
class="emmi-10"><img 
src="emmi10-d.gif"alt="g"class="10--d"> </span>= <span 
class="emmi-10">E/m</span><sub ><span 
class="emmi-7">x</span></sub> , <span 
class="emmi-10">E </span>is energy and <span 
class="emmi-10">m</span><sub ><span 
class="emmi-7">x</span></sub> the mass of the incident particle, <span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"></span><sup ><span 
class="emr-7">2</span></sup> = 1 <span 
class="cmsy-10">- </span>1<span 
class="emmi-10">/<img 
src="emmi10-d.gif"alt="g"class="10--d"></span><sup ><span 
class="emr-7">2</span></sup> and
<span 
class="emmi-10">m</span><sub ><span 
class="emmi-7">e</span></sub> is the electron mass. <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"> </span>comes from the Rutherford scattering cross section and is
defined as: <div align="center" class="eqnarray"><a 
   name="1-1001r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"> </span>= 2<span 
class="emmi-10"><img 
src="emmi10-19.gif"alt="p"class="10--19">z</span><sup ><span 
class="emr-7">2</span></sup><span 
class="emmi-10">e</span><sup ><span 
class="emr-7">4</span></sup><span 
class="emmi-10">N</span><sub ><span 
class="emmi-7">Av</span></sub><span 
class="emmi-10">Z<img 
src="emmi10-1a.gif"alt="r"class="emmi-10--1a"align="middle"><img 
src="emmi10-e.gif"alt="d"class="10--e">x</span> 
     <span 
class="emmi-10">m</span><sub ><span 
class="emmi-7">e</span></sub><span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"></span><sup ><span 
class="emr-7">2</span></sup><span 
class="emmi-10">c</span><sup ><span 
class="emr-7">2</span></sup><span 
class="emmi-10">A</span>      = 153<span 
class="emmi-10">.</span>4 <span 
class="emmi-10">z</span><sup ><span 
class="emr-7">2</span></sup>
<span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"></span><sup ><span 
class="emr-7">2</span></sup> <span 
class="emmi-10">Z</span> 
<span 
class="emmi-10">A</span><span 
class="emmi-10"><img 
src="emmi10-1a.gif"alt="r"class="emmi-10--1a"align="middle"><img 
src="emmi10-e.gif"alt="d"class="10--e">x</span>   keV<span 
class="emmi-10">,</span></td><td 
align="center"nowrap 
class="eqnarray2"></td><td 
align="left"nowrap 
class="eqnarray3"></td></tr></table>
</div>where
   <div align="center"><table class="tabular" 
cellspacing="0pt" cellpadding="0"  
frame="void" ><colgroup><col 
id="TBL-2-1"><col 
id="TBL-2-2"></colgroup><tr  
valign="baseline" id="TBL-2-1-"><td  align="left"nowrap id="TBL-2-1-1"  
><div class="td11"><span 
class="emmi-10">z     </span></div></td><td  align="left"nowrap id="TBL-2-1-2"  
><div class="td11">charge of the incident particle </div></td>
</tr><tr  
valign="baseline" id="TBL-2-2-"><td  align="left"nowrap id="TBL-2-2-1"  
><div class="td11"><span 
class="emmi-10">N</span><sub ><span 
class="emmi-7">Av</span></sub></div></td><td  align="left"nowrap id="TBL-2-2-2"  
><div class="td11">Avogadro's number               </div></td>
</tr><tr  
valign="baseline" id="TBL-2-3-"><td  align="left"nowrap id="TBL-2-3-1"  
><div class="td11"><span 
class="emmi-10">Z    </span></div></td><td  align="left"nowrap id="TBL-2-3-2"  
><div class="td11">atomic number of the material</div></td>
</tr><tr  
valign="baseline" id="TBL-2-4-"><td  align="left"nowrap id="TBL-2-4-1"  
><div class="td11"><span 
class="emmi-10">A    </span></div></td><td  align="left"nowrap id="TBL-2-4-2"  
><div class="td11">atomic weight of the material </div></td>
</tr><tr  
valign="baseline" id="TBL-2-5-"><td  align="left"nowrap id="TBL-2-5-1"  
><div class="td11"><span 
class="emmi-10"><img 
src="emmi10-1a.gif"alt="r"class="emmi-10--1a"align="middle">    </span></div></td><td  align="left"nowrap id="TBL-2-5-2"  
><div class="td11">density                               </div></td>
</tr><tr  
valign="baseline" id="TBL-2-6-"><td  align="left"nowrap id="TBL-2-6-1"  
><div class="td11"><span 
class="emmi-10"><img 
src="emmi10-e.gif"alt="d"class="10--e">x   </span></div></td><td  align="left"nowrap id="TBL-2-6-2"  
><div class="td11">thickness of the material        </div></td>
</tr><tr  
valign="baseline" id="TBL-2-7-"><td  align="left"nowrap id="TBL-2-7-1"  
><div class="td11">      </div></td> </tr></table>
</div>
<!--57--><p class="indent">   <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span>measures the contribution of the collisions with energy transfer close to <span 
class="emmi-10">E</span><span 
class="emr-7">max</span>.
For a given absorber, <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span>tends towards large values if <span 
class="emmi-10"><img 
src="emmi10-e.gif"alt="d"class="10--e">x </span>is large and/or if <span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"> </span>is
small. Likewise, <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span>tends towards zero if <span 
class="emmi-10"><img 
src="emmi10-e.gif"alt="d"class="10--e">x </span>is small and/or if <span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"> </span>approaches
1.
<!--63--><p class="indent">   The value of <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span>distinguishes two regimes which occur in the description of
ionisation fluctuations :
     <ol type="1"class="enumerate1" 
>
     <li class="enumerate"><a 
   name="1-1003x1"></a>A large number of collisions involving the loss of all or most of the incident
     particle energy during the traversal of an absorber.
     <!--70--><p class="noindent">As the total energy transfer is composed of a multitude of small energy
     losses, we can apply the central limit theorem and describe the fluctuations
     by  a  Gaussian  distribution.  This  case  is  applicable  to  non-relativistic
     particles and is described by the inequality <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> &gt; </span>10 (i.e. when the mean
     energy loss in the absorber is greater than the maximum energy transfer
     in a single collision).
     </li>
     <li class="enumerate"><a 
   name="1-1005x2"></a>Particles  traversing  thin  counters  and  incident  electrons  under  any
     conditions.
     <!--81--><p class="noindent">The relevant inequalities and distributions are 0<span 
class="emmi-10">.</span>01 <span 
class="emmi-10">&lt; <img 
src="emmi10-14.gif"alt="k"class="10--14"> &lt; </span>10, Vavilov
     distribution, and <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> &lt; </span>0<span 
class="emmi-10">.</span>01, Landau distribution.</li></ol>
<!--83--><p class="noindent">
<!--85--><p class="indent">   An additional regime is defined by the contribution of the collisions with low
energy transfer which can be estimated with the relation <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle">/I</span><sub ><span 
class="emr-7">0</span></sub>, where <span 
class="emmi-10">I</span><sub ><span 
class="emr-7">0</span></sub> is the mean
ionisation potential of the atom. Landau theory assumes that the number of these
collisions is high, and consequently, it has a restriction <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle">/I</span><sub ><span 
class="emr-7">0</span></sub> <span 
class="cmsy-10">» </span>1. In <span 
class="emtt-10">GEANT </span>(see URL
<span 
class="emtt-10">http://wwwinfo.cern.ch/asdoc/geant/geantall.html</span>), the limit of Landau
theory has been set at <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle">/I</span><sub ><span 
class="emr-7">0</span></sub> = 50. Below this limit special models taking into account
the atomic structure of the material are used. This is important in thin layers and
gaseous materials. Figure <a 
 href="#1-10061">1</a> shows the behaviour of <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle">/I</span><sub ><span 
class="emr-7">0</span></sub> as a function of the layer
thickness for an electron of 100 keV and 1 GeV of kinetic energy in Argon, Silicon
and Uranium.
<a 
   name="1-10061"></a>
   <hr class="float"><div align="center" class="float" 
><table class="float"><tr class="float"><td class="float" 
>
<img 
src="latexexa2x.gif"alt="PIC">
<br><div align="center"class="caption"><table class="caption" 
><tr valign="baseline" class="caption"><td class="id">Figure 1</td><td  
class="content">The variable <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle">/I</span><sub ><span 
class="emr-7">0</span></sub>  can be used to measure the validity range of the
Landau theory. It depends on the type and energy of the particle, <span 
class="emmi-10">Z </span>, <span 
class="emmi-10">A </span>and the
ionisation potential of the material and the layer thickness. </td></tr></table></div>
   </td></tr></table></div><hr class="endfloat">
<!--110--><p class="indent">   In the following sections, the different theories and models for the energy loss
fluctuation are described. First, the Landau theory and its limitations are discussed,
and then, the Vavilov and Gaussian straggling functions and the methods in the thin
layers and gaseous materials are presented.
   <h2 class="sectionHead">2 <a 
   name="1-20002"></a><a 
   name="QQ1-1-3"></a>Landau theory</h2>
<!--119--><p class="noindent">For a particle of mass <span 
class="emmi-10">m</span><sub ><span 
class="emmi-7">x</span></sub> traversing a thickness of material <span 
class="emmi-10"><img 
src="emmi10-e.gif"alt="d"class="10--e">x</span>, the Landau
probability distribution may be written in terms of the universal Landau function
<span 
class="emmi-10"><img 
src="emmi10-1e.gif"alt="f"class="10--1e"></span>(<span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span>) as[<a 
 href="#Xbib-LAND">1</a>]: <div align="center" class="eqnarray"><a 
   name="1-2001r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">f</span>(<span 
class="emmi-10"><img 
src="emmi10-f.gif"alt="e"class="10--f">, <img 
src="emmi10-e.gif"alt="d"class="10--e">x</span>)</td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">1
        <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"></span> <span 
class="emmi-10"><img 
src="emmi10-1e.gif"alt="f"class="10--1e"></span>(<span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span>)</td></tr></table>
</div>where <div align="center" class="eqnarray"><a 
   name="1-2002r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-1e.gif"alt="f"class="10--1e"></span>(<span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span>)</td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"> 1_
2<span 
class="emmi-10"><img 
src="emmi10-19.gif"alt="p"class="10--19">i</span> <span 
class="cmex-10"><img 
src="cmex10-5a.gif"alt=" integral "class="cmex-10--5a"align="middle"></span>
     <sub> <span 
class="emmi-10">c </span><span 
class="cmsy-10">- </span><span 
class="emmi-10">i</span><span 
class="cmsy-10"><img 
src="cmsy10-31.gif"alt=" oo "class="10--31"></span></sub><sup><span 
class="emmi-10">c </span>+ <span 
class="emmi-10">i</span><span 
class="cmsy-10"><img 
src="cmsy10-31.gif"alt=" oo "class="10--31"></span></sup> exp <img 
src="latexexa3x.gif"alt="(u ln u+ cu)"class="left" align="middle"> <span 
class="emmi-10">du</span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span>                 <span 
class="emmi-10">c </span><span 
class="cmsy-10"><span 
class="underline">&gt;</span> </span>0</td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span></td>   <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10"><img 
src="emmi10-f.gif"alt="e"class="10--f"> </span><span 
class="cmsy-10">-</span> <img 
src="latexexa4x.gif"alt="e"class="bar" >
       <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"></span>  <span 
class="cmsy-10">- </span><span 
class="emmi-10"><img 
src="emmi10-d.gif"alt="g"class="10--d"></span><span 
class="cmsy-7">'</span> <span 
class="cmsy-10">- </span><span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"></span><sup ><span 
class="emr-7">2</span></sup> <span 
class="cmsy-10">-</span> ln    <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"></span> ___
<span 
class="emmi-10">E</span><span 
class="emr-7">max</span> </td>                                 </tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-d.gif"alt="g"class="10--d"></span><span 
class="cmsy-7">'</span></td>  <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">0<span 
class="emmi-10">.</span>422784 <span 
class="emmi-10">. . .</span> = 1 <span 
class="cmsy-10">- </span><span 
class="emmi-10"><img 
src="emmi10-d.gif"alt="g"class="10--d"></span></td>                                      </tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-d.gif"alt="g"class="10--d"></span></td>   <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">0<span 
class="emmi-10">.</span>577215 <span 
class="emmi-10">. . .</span> (Euler's constant)</td>                             </tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><img 
src="latexexa5x.gif"alt="e"class="bar" ></td>   <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">average energy loss</td>                                      </tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-f.gif"alt="e"class="10--f"></span></td>   <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">actual energy loss</td>                                        </tr></table>
</div>
   <h3 class="subsectionHead">2.1 <a 
   name="1-30002.1"></a><a 
   name="QQ1-1-4"></a>Restrictions</h3>
<!--140--><p class="noindent">The Landau formalism makes two restrictive assumptions :
     <ol type="1"class="enumerate1" 
>
     <li class="enumerate"><a 
   name="1-3002x1"></a>The typical energy loss is small compared to the maximum energy loss in
     a single collision. This restriction is removed in the Vavilov theory (see
     section <a 
 href="#1-40003">3</a>).
     </li>
     <li class="enumerate"><a 
   name="1-3004x2"></a>The typical energy loss in the absorber should be large compared to the
     binding energy of the most tightly bound electron. For gaseous detectors,
     typical energy losses are a few keV which is comparable to the binding
     energies of the inner electrons. In such cases a more sophisticated approach
     which  accounts  for  atomic  energy  levels[<a 
 href="#Xbib-TALM">4</a>]  is  necessary  to  accurately
     simulate data distributions. In <span 
class="emtt-10">GEANT</span>, a parameterised model by L. Urb&aacute;n
     is used (see section <a 
 href="#1-60005">5</a>).</li></ol>
<!--153--><p class="noindent">
<!--155--><p class="indent">   In addition, the average value of the Landau distribution is infinite. Summing the
Landau fluctuation obtained to the average energy from the <span 
class="emmi-10">dE/dx </span>tables, we
obtain a value which is larger than the one coming from the table. The
probability to sample a large value is small, so it takes a large number of steps
(extractions) for the average fluctuation to be significantly larger than zero. This
introduces a dependence of the energy loss on the step size which can affect
calculations.
<!--164--><p class="indent">   A solution to this has been to introduce a limit on the value of the variable
sampled by the Landau distribution in order to keep the average fluctuation to 0.
The value obtained from the <span 
class="emtt-10">GLANDO </span>routine is:
   <center>
<img 
src="latexexa6x.gif"alt="ddE/dx = e- e = q(c -g'+ b2 + ln--q-)
                               Emax"class="mathdisplay"></center> In
order for this to have average 0, we must impose that:
   <center>
<img 
src="latexexa7x.gif"alt="c = -g'- b2 -ln -q---
                Emax"class="mathdisplay"></center>
<!--177--><p class="indent">   This is realised introducing a <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emr-7">max</span></sub>(<img 
src="latexexa8x.gif"alt="c"class="bar" >) such that if only values of <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"> </span><span 
class="cmsy-10"><span 
class="underline">&lt;</span> </span><span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emr-7">max</span></sub> are
accepted, the average value of the distribution is <img 
src="latexexa9x.gif"alt="c"class="bar" >.
<!--181--><p class="indent">   A parametric fit to the universal Landau distribution has been performed, with
following result:
   <center>
<img 
src="latexexa10x.gif"alt="cmax = 0.60715+ 1.1934c + (0.67794+ 0.052382c)exp(0.94753 +0.74442c)"class="mathdisplay"></center>
only values smaller than <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emr-7">max</span></sub> are accepted, otherwise the distribution is
resampled.
   <h2 class="sectionHead">3 <a 
   name="1-40003"></a><a 
   name="QQ1-1-5"></a>Vavilov theory</h2>
<!--197--><p class="noindent">Vavilov[<a 
 href="#Xbib-VAVI">5</a>] derived a more accurate straggling distribution by introducing the
kinematic limit on the maximum transferable energy in a single collision, rather than
using <span 
class="emmi-10">E</span><span 
class="emr-7">max</span> = <span 
class="cmsy-10"><img 
src="cmsy10-31.gif"alt=" oo "class="10--31"></span>. Now we can write[<a 
 href="#Xbib-SCH1">2</a>]: <div align="center" class="eqnarray"><a 
   name="1-4001r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">f</span><img 
src="latexexa11x.gif"alt="(e,ds)"class="left" align="middle"></td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">1
        <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"></span> <span 
class="emmi-10"><img 
src="emmi10-1e.gif"alt="f"class="10--1e"></span><sub ><span 
class="emmi-7">v</span></sub><img 
src="latexexa12x.gif"alt="(       )
 cv,k,b2"class="left" align="middle"></td></tr></table>
</div>where <div align="center" class="eqnarray"><a 
   name="1-4002r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-1e.gif"alt="f"class="10--1e"></span><sub ><span 
class="emmi-7">v</span></sub><img 
src="latexexa13x.gif"alt="(cv,k,b2)"class="left" align="middle"></td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"> 1_
2<span 
class="emmi-10"><img 
src="emmi10-19.gif"alt="p"class="10--19">i</span> <span 
class="cmex-10"><img 
src="cmex10-5a.gif"alt=" integral "class="cmex-10--5a"align="middle"></span>
     <sub> <span 
class="emmi-10">c </span><span 
class="cmsy-10">- </span><span 
class="emmi-10">i</span><span 
class="cmsy-10"><img 
src="cmsy10-31.gif"alt=" oo "class="10--31"></span></sub><sup><span 
class="emmi-10">c </span>+ <span 
class="emmi-10">i</span><span 
class="cmsy-10"><img 
src="cmsy10-31.gif"alt=" oo "class="10--31"></span></sup><span 
class="emmi-10"><img 
src="emmi10-1e.gif"alt="f"class="10--1e"></span><img 
src="latexexa14x.gif"alt="(s)"class="left" align="middle"> <span 
class="emmi-10">e</span><sup ><span 
class="emmi-7"><img 
src="emmi7-15.gif"alt="c"class="7--15">s</span></sup><span 
class="emmi-10">ds</span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span><span 
class="emmi-10"> </span>                 <span 
class="emmi-10">c </span><span 
class="cmsy-10"><span 
class="underline">&gt;</span> </span>0</td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-1e.gif"alt="f"class="10--1e"></span><img 
src="latexexa15x.gif"alt="(s)"class="left" align="middle"></td>       <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">exp <img 
src="latexexa16x.gif"alt="[      2  ]
 k(1+ b g)"class="left" align="middle"> <span 
class="emmi-10"> </span> exp <img 
src="latexexa17x.gif"alt="[y(s)]"class="left" align="middle"> <span 
class="emmi-10">,</span> </td>                     </tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-20.gif"alt="y"class="10--20"></span><img 
src="latexexa18x.gif"alt="(s)"class="left" align="middle"></td>       <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10">s</span> ln <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span>+ (<span 
class="emmi-10">s </span>+ <span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"></span><sup ><span 
class="emr-7">2</span></sup><span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"></span>)<img 
src="latexexa19x.gif"alt="[ln(s/k)+ E1(s/k)]"class="left" align="middle"> <span 
class="cmsy-10">- </span><span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14">e</span><sup ><span 
class="cmsy-7">-</span><span 
class="emmi-7">s/<img 
src="emmi7-14.gif"alt="k"class="7--14"></span></sup><span 
class="emmi-10">,</span></td>       </tr></table>
</div>and <div align="center" class="eqnarray"><a 
   name="1-4003r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">E</span><sub ><span 
class="emr-7">1</span></sub>(<span 
class="emmi-10">z</span>)</td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="cmex-10"><img 
src="cmex10-5a.gif"alt=" integral "class="cmex-10--5a"align="middle"></span>
  <sub> <span 
class="emmi-10">z</span></sub><sup><span 
class="cmsy-10"><img 
src="cmsy10-31.gif"alt=" oo "class="10--31"></span></sup><span 
class="emmi-10">t</span><sup ><span 
class="cmsy-7">-</span><span 
class="emr-7">1</span></sup><span 
class="emmi-10">e</span><sup ><span 
class="cmsy-7">-</span><span 
class="emmi-7">t</span></sup><span 
class="emmi-10">dt</span>            (the exponential integral)</td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emmi-7">v</span></sub></td>   <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"></span><img 
src="latexexa20x.gif"alt="[             ]
 e--e - g'- b2
   q"class="left" align="middle"></td>                          </tr></table>
</div>
<!--224--><p class="indent">   The Vavilov parameters are simply related to the Landau parameter by
<span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emmi-7">L</span></sub> = <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emmi-7">v</span></sub><span 
class="emmi-10">/<img 
src="emmi10-14.gif"alt="k"class="10--14"> </span><span 
class="cmsy-10">-</span> ln <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"></span>. It can be shown that as <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span><span 
class="cmsy-10"><img 
src="cmsy10-21.gif"alt="--&gt;"class="10--21"> </span>0, the distribution of the variable <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emmi-7">L</span></sub>
approaches that of Landau. For <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span><span 
class="cmsy-10"><span 
class="underline">&lt;</span> </span>0<span 
class="emmi-10">.</span>01 the two distributions are already practically
identical. Contrary to what many textbooks report, the Vavilov distribution <span 
class="emti-10">does not</span>
approximate the Landau distribution for small <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"></span>, but rather the distribution of <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emmi-7">L</span></sub>
defined above tends to the distribution of the true <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"> </span>from the Landau density
function. Thus the routine <span 
class="emtt-10">GVAVIV </span>samples the variable <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emmi-7">L</span></sub> rather than <span 
class="emmi-10"><img 
src="emmi10-15.gif"alt="c"class="10--15"></span><sub ><span 
class="emmi-7">v</span></sub>. For
<span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span><span 
class="cmsy-10"><span 
class="underline">&gt;</span> </span>10 the Vavilov distribution tends to a Gaussian distribution (see next
section).
   <h2 class="sectionHead">4 <a 
   name="1-50004"></a><a 
   name="QQ1-1-6"></a>Gaussian Theory</h2>
<!--239--><p class="noindent">Various conflicting forms have been proposed for Gaussian straggling functions, but
most of these appear to have little theoretical or experimental basis. However, it has
been shown[<a 
 href="#Xbib-SELT">3</a>] that for <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"> </span><span 
class="cmsy-10"><span 
class="underline">&gt;</span> </span>10 the Vavilov distribution can be replaced by a Gaussian
of the form : <div align="center" class="eqnarray"><a 
   name="1-5001r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">f</span>(<span 
class="emmi-10"><img 
src="emmi10-f.gif"alt="e"class="10--f">, <img 
src="emmi10-e.gif"alt="d"class="10--e">s</span>) <span 
class="cmsy-10"><img 
src="cmsy10-19.gif"alt=" ~~ "class="10--19"></span>            1 __________
<span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"></span><img 
src="latexexa21x.gif"alt=" V~ ------------
  2pk (1- b2/2)"class="sqrtsign" > exp <img 
src="latexexa22x.gif"alt="[(e- e)2     k     ]
 --------2-----2---
    2   q (1- b /2)"class="left" align="middle"></td><td 
align="center"nowrap 
class="eqnarray2"></td><td 
align="left"nowrap 
class="eqnarray3"></td></tr></table>
</div>thus implying <div align="center" class="eqnarray"><a 
   name="1-5002r1"></a>
<table 
class="eqnarray-star"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1">mean</td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><img 
src="latexexa23x.gif"alt="e"class="bar" ></td>                          </tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sup ><span 
class="emr-7">2</span></sup></td>  <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle"></span><sup ><span 
class="emr-7">2</span></sup>
       <span 
class="emmi-10"><img 
src="emmi10-14.gif"alt="k"class="10--14"></span> (1 <span 
class="cmsy-10">- </span><span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"></span><sup ><span 
class="emr-7">2</span></sup><span 
class="emmi-10">/</span>2) = <span 
class="emmi-10"><img 
src="emmi10-18.gif"alt="q"class="emmi-10--18"align="middle">E</span>
<span 
class="emr-7">max</span>(1 <span 
class="cmsy-10">- </span><span 
class="emmi-10"><img 
src="emmi10-c.gif"alt="b"class="emmi-10--c"align="middle"></span><sup ><span 
class="emr-7">2</span></sup><span 
class="emmi-10">/</span>2)</td></tr></table>
</div>
   <h2 class="sectionHead">5 <a 
   name="1-60005"></a><a 
   name="QQ1-1-7"></a>Urb&aacute;n model</h2>
<!--260--><p class="noindent">The method for computing restricted energy losses with <span 
class="emmi-10"><img 
src="emmi10-e.gif"alt="d"class="10--e"></span>-ray production
above given threshold energy in <span 
class="emtt-10">GEANT </span>is a Monte Carlo method that can
be used for thin layers. It is fast and it can be used for any thickness of
a medium. Approaching the limit of the validity of Landau's theory, the
loss distribution approaches smoothly the Landau form as shown in Figure
<a 
 href="#1-60012">2</a>.
<a 
   name="1-60012"></a>
   <hr class="float"><div align="center" class="float" 
><table class="float"><tr class="float"><td class="float" 
>
<img 
src="latexexa24x.gif"alt="PIC">
<br><div align="center"class="caption"><table class="caption" 
><tr valign="baseline" class="caption"><td class="id">Figure 2</td><td  
class="content">Energy loss distribution for a 3 GeV electron in Argon as given by
standard <span 
class="emtt-10">GEANT</span>. The width of the layers is given in centimeters.</td></tr></table></div>
   </td></tr></table></div><hr class="endfloat">
<!--275--><p class="indent">   It is assumed that the atoms have only two energy levels with binding energy <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">1</span></sub>
and <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">2</span></sub>. The particle--atom interaction will then be an excitation with energy loss <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">1</span></sub>
or <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">2</span></sub>, or an ionisation with an energy loss distributed according to a function
<span 
class="emmi-10">g</span>(<span 
class="emmi-10">E</span>) <span 
class="cmsy-10">~ </span>1<span 
class="emmi-10">/E</span><sup ><span 
class="emr-7">2</span></sup>: <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa25x.gif"alt="       (Emax +-I)I-1
g(E) =    Emax   E2"class="mathdisplay"><a 
   name="1-6002r1"></a></center></td><td width="5%">(1)</td></tr></table>
<!--283--><p class="indent">   The macroscopic cross-section for excitations (<span 
class="emmi-10">i </span>= 1<span 
class="emmi-10">, </span>2) is <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa26x.gif"alt="     f ln(2mb2g2/E  )- b2
i = C-i-------2-2-i----2 (1- r)
     Ei ln(2mb  g/I) - b"class="mathdisplay"><a 
   name="1-6003r2"></a></center></td><td width="5%">(2)</td></tr></table>
and the macroscopic cross-section for ionisation is <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa27x.gif"alt="3 = C-------Emax---------r
     I(Emax + I)ln(EmaIx+I)"class="mathdisplay"><a 
   name="1-6004r3"></a></center></td><td width="5%">(3)</td></tr></table>
<span 
class="emmi-10">E</span><span 
class="emr-7">max</span> is the <span 
class="emtt-10">GEANT </span>cut for <span 
class="emmi-10"><img 
src="emmi10-e.gif"alt="d"class="10--e"></span>-production, or the maximum energy transfer minus mean
ionisation energy, if it is smaller than this cut-off value. The following notation is
used:
   <div align="center"><table class="tabular" 
cellspacing="0pt" cellpadding="0"  
frame="void" ><colgroup><col 
id="TBL-3-1"><col 
id="TBL-3-2"></colgroup><tr  
valign="baseline" id="TBL-3-1-"><td  align="left"nowrap id="TBL-3-1-1"  
><div class="td11"><span 
class="emmi-10">r, C</span></div></td><td  align="left"nowrap id="TBL-3-1-2"  
><div class="td11">parameters of the model</div></td>
</tr><tr  
valign="baseline" id="TBL-3-2-"><td  align="left"nowrap id="TBL-3-2-1"  
><div class="td11"><span 
class="emmi-10">E</span><sub ><span 
class="emmi-7">i</span></sub>  </div></td><td  align="left"nowrap id="TBL-3-2-2"  
><div class="td11">atomic energy levels      </div></td>
</tr><tr  
valign="baseline" id="TBL-3-3-"><td  align="left"nowrap id="TBL-3-3-1"  
><div class="td11"><span 
class="emmi-10">I    </span></div></td><td  align="left"nowrap id="TBL-3-3-2"  
><div class="td11">mean ionisation energy  </div></td>
</tr><tr  
valign="baseline" id="TBL-3-4-"><td  align="left"nowrap id="TBL-3-4-1"  
><div class="td11"><span 
class="emmi-10">f</span><sub ><span 
class="emmi-7">i</span></sub>   </div></td><td  align="left"nowrap id="TBL-3-4-2"  
><div class="td11">oscillator strengths       </div></td> </tr></table>
</div>
<!--306--><p class="indent">   The model has the parameters <span 
class="emmi-10">f</span><sub ><span 
class="emmi-7">i</span></sub> , <span 
class="emmi-10">E</span><sub ><span 
class="emmi-7">i</span></sub> , <span 
class="emmi-10">C </span>and <span 
class="emmi-10">r</span><span 
class="emmi-10"> </span>(0 <span 
class="cmsy-10"><span 
class="underline">&lt;</span> </span><span 
class="emmi-10">r </span><span 
class="cmsy-10"><span 
class="underline">&lt;</span> </span>1). The oscillator
strengths <span 
class="emmi-10">f</span><sub ><span 
class="emmi-7">i</span></sub>  and the atomic level energies <span 
class="emmi-10">E</span><sub ><span 
class="emmi-7">i</span></sub>  should satisfy the constraints
<div align="center" class="eqnarray"><a 
   name="1-6005r4"></a>
<table 
class="eqnarray"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">f</span><sub ><span 
class="emr-7">1</span></sub> + <span 
class="emmi-10">f</span><sub ><span 
class="emr-7">2</span></sub></td>         <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">1</td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(4)<a 
   name="1-6005r5"></a></td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">f</span><sub ><span 
class="emr-7">1</span></sub> ln <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">1</span></sub> + <span 
class="emmi-10">f</span><sub ><span 
class="emr-7">2</span></sub> ln <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">2</span></sub></td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">ln <span 
class="emmi-10">I</span></td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(5)<a 
   name="1-6005r6"></a></td></tr></table>
</div>The parameter <span 
class="emmi-10">C </span>can be defined with the help of the mean energy loss <span 
class="emmi-10">dE/dx </span>in the
following way: The numbers of collisions (<span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">i</span></sub> , i = 1,2 for the excitation and 3 for the
ionisation) follow the Poisson distribution with a mean number <span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">i</span></sub><span 
class="cmsy-10">&gt;</span>. In a step <span 
class="emmi-10">x</span>
the mean number of collisions is <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa28x.gif"alt="&lt;n&gt; =    x
  i    i"class="mathdisplay"><a 
   name="1-6006r6"></a></center></td><td width="5%">(6)</td></tr></table>
The mean energy loss <span 
class="emmi-10">dE/dx </span>in a step is the sum of the excitation and ionisation
contributions <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa29x.gif"alt="        [                                 ]
dE                        integral  Emax+I
dx- x =   1E1 +  2E2 +  3        E g(E) dE   x
                          I"class="mathdisplay"><a 
   name="1-6007r7"></a></center></td><td width="5%">(7)</td></tr></table>
From this, using the equations (<a 
 href="#1-6003r2">2</a>), (<a 
 href="#1-6004r3">3</a>), (<a 
 href="#1-6005r4">4</a>) and (<a 
 href="#1-6005r5">5</a>), one can define the parameter <span 
class="emmi-10">C</span>
<table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa30x.gif"alt="C = dE-
    dx"class="mathdisplay"><a 
   name="1-6008r8"></a></center></td><td width="5%">(8)</td></tr></table>
<!--335--><p class="indent">   The following values have been chosen in <span 
class="emtt-10">GEANT </span>for the other parameters:
   <center>
<img 
src="latexexa31x.gif"alt="    {
       0    ifZ &lt; 2
f2 =   2/Z  ifZ &gt; 2   ==&gt;  f1 = 1- f2
                              (    )f11
E2 = 10Z2eV           ==&gt;  E1 =   EIf2
r = 0.4                           2"class="mathdisplay"></center> With
these values the atomic level <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">2</span></sub> corresponds approximately the K-shell energy of the
atoms and <span 
class="emmi-10">Zf</span><sub ><span 
class="emr-7">2</span></sub> the number of K-shell electrons. <span 
class="emmi-10">r </span>is the only variable which can be
tuned freely. It determines the relative contribution of ionisation and excitation to
the energy loss.
<!--354--><p class="indent">   The energy loss is computed with the assumption that the step length (or the
relative energy loss) is small, and---in consequence---the cross-section can be
considered constant along the path length. The energy loss due to the excitation is
<table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa32x.gif"alt="Ee = n1E1 +n2E2"class="mathdisplay"><a 
   name="1-6009r9"></a></center></td><td width="5%">(9)</td></tr></table>
where <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">1</span></sub> and <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">2</span></sub> are sampled from Poisson distribution as discussed above. The loss
due to the ionisation can be generated from the distribution <span 
class="emmi-10">g</span>(<span 
class="emmi-10">E</span>) by the inverse
transformation method: <div align="center" class="eqnarray"><a 
   name="1-6010r10"></a>
<table 
class="eqnarray"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">u </span>= <span 
class="emmi-10">F</span>(<span 
class="emmi-10">E</span>)</td>  <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="cmex-10"><img 
src="cmex10-5a.gif"alt=" integral "class="cmex-10--5a"align="middle"></span>
  <sub> <span 
class="emmi-10">I</span></sub><sup><span 
class="emmi-10">E</span></sup><span 
class="emmi-10">g</span>(<span 
class="emmi-10">x</span>)<span 
class="emmi-10">dx</span></td> <td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4"></td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10">E </span>= <span 
class="emmi-10">F</span><sup ><span 
class="cmsy-7">-</span><span 
class="emr-7">1</span></sup>(<span 
class="emmi-10">u</span>)</td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3">     <span 
class="emmi-10">I</span>_____
1 <span 
class="cmsy-10">- </span><span 
class="emmi-10">u</span>  <span 
class="emmi-7">E</span><span 
class="emr-5">max</span>__
<span 
class="emmi-7">E</span><span 
class="emr-5">max</span><span 
class="emr-7">+</span><span 
class="emmi-7">I</span> </td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(10)<a 
   name="1-6010r11"></a></td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"></td>          <td 
align="center"nowrap 
class="eqnarray2"></td> <td 
align="left"nowrap 
class="eqnarray3"></td>       <td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(11)<a 
   name="1-6010r12"></a></td></tr></table>
</div>where <span 
class="emmi-10">u </span>is a uniform random number between <span 
class="emmi-10">F</span>(<span 
class="emmi-10">I</span>) = 0 and <span 
class="emmi-10">F</span>(<span 
class="emmi-10">E</span><span 
class="emr-7">max</span> + <span 
class="emmi-10">I</span>) = 1. The
contribution from the ionisations will be <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa33x.gif"alt="     n sum 3 -----I------
Ei =    1 -uj -Emax--
     j=1      Emax+I"class="mathdisplay"><a 
   name="1-6011r12"></a></center></td><td width="5%">(12)</td></tr></table>
where <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub> is the number of ionisation (sampled from Poisson distribution). The
energy loss in a step will then be <span 
class="emmi-10">E </span>= <span 
class="emmi-10">E</span><sub ><span 
class="emmi-7">e</span></sub> + <span 
class="emmi-10">E</span><sub ><span 
class="emmi-7">i</span></sub>.
   <h3 class="subsectionHead">5.1 <a 
   name="1-70005.1"></a><a 
   name="QQ1-1-9"></a>Fast simulation for <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub> <span 
class="cmsy-10"><span 
class="underline">&gt;</span> </span>16</h3>
<!--380--><p class="noindent">If the number of ionisation <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub> is bigger than 16, a faster sampling method can be
used. The possible energy loss interval is divided in two parts: one in which the
number of collisions is large and the sampling can be done from a Gaussian
distribution and the other in which the energy loss is sampled for each collision. Let
us call the former interval [<span 
class="emmi-10">I, <img 
src="emmi10-b.gif"alt="a"class="10--b">I</span>] the interval A, and the latter [<span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b">I, E</span><span 
class="emr-7">max</span>] the interval
B. <span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b"> </span>lies between 1 and <span 
class="emmi-10">E</span><span 
class="emr-7">max</span><span 
class="emmi-10">/I</span>. A collision with a loss in the interval A happens
with the probability <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa34x.gif"alt="       integral  aI
P(a) =    g(E)dE = (Emax-+-I)(a---1)
       I                Emaxa"class="mathdisplay"><a 
   name="1-7001r13"></a></center></td><td width="5%">(13)</td></tr></table>
The mean energy loss and the standard deviation for this type of collision are
<table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa35x.gif"alt="          --1--  integral  aI          Ia-lna-
&lt;  E(a)&gt; = P (a) I E g(E) dE =  a- 1"class="mathdisplay"><a 
   name="1-7002r14"></a></center></td><td width="5%">(14)</td></tr></table>
and <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa36x.gif"alt="              integral  aI              (        2  )
s2(a) =--1--    E2 g(E) dE = I2a  1 - -aln-a2
       P (a) I                      (a- 1)"class="mathdisplay"><a 
   name="1-7003r15"></a></center></td><td width="5%">(15)</td></tr></table>
If the collision number is high , we assume that the number of the type A collisions
can be calculated from a Gaussian distribution with the following mean value and
standard deviation: <div align="center" class="eqnarray"><a 
   name="1-7004r16"></a>
<table 
class="eqnarray"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="cmsy-10">&gt;</span></td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub><span 
class="emmi-10">P</span>(<span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b"></span>)</td>      <td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(16)<a 
   name="1-7004r17"></a></td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sub><span 
class="emmi-10">A</span></sub><sup>2</sup></td> <td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub><span 
class="emmi-10">P</span>(<span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b"></span>)(1 <span 
class="cmsy-10">- </span><span 
class="emmi-10">P</span>(<span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b"></span>))</td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(17)<a 
   name="1-7004r18"></a></td></tr></table>
</div>It is further assumed that the energy loss in these collisions has a Gaussian
distribution with <div align="center" class="eqnarray"><a 
   name="1-7005r18"></a>
<table 
class="eqnarray"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">E</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="cmsy-10">&gt;</span></td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">E</span>(<span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b"></span>)<span 
class="cmsy-10">&gt;</span></td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(18)<a 
   name="1-7005r19"></a></td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="emmi-10"><img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sub><span 
class="emmi-10">E, A</span></sub><sup>2</sup></td><td 
align="center"nowrap 
class="eqnarray2">=</td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="emmi-10"><img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sup ><span 
class="emr-7">2</span></sup>(<span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b"></span>)</td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(19)<a 
   name="1-7005r20"></a></td></tr></table>
</div>The energy loss of these collision can then be sampled from the Gaussian
distribution.
<!--427--><p class="indent">   The collisions where the energy loss is in the interval B are sampled directly from
<table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa37x.gif"alt="      n3- sum  nA      aI
EB  =      1--u-Emax+I-aI
       i=1       i Emax+I"class="mathdisplay"><a 
   name="1-7006r20"></a></center></td><td width="5%">(20)</td></tr></table>
The total energy loss is the sum of these two types of collisions: <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa38x.gif"alt="E =   EA +   EB"class="mathdisplay"><a 
   name="1-7007r21"></a></center></td><td width="5%">(21)</td></tr></table>
<!--438--><p class="indent">   The approximation of equations ((<a 
 href="#1-7004r16">16</a>), (<a 
 href="#1-7004r17">17</a>), (<a 
 href="#1-7005r18">18</a>) and (<a 
 href="#1-7005r19">19</a>) can be used under the
following conditions: <div align="center" class="eqnarray"><a 
   name="1-7008r22"></a>
<table 
class="eqnarray"><tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="cmsy-10">&gt; - </span><span 
class="emmi-10">c <img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sub ><span 
class="emmi-7">A</span></sub></td>    <td 
align="center"nowrap 
class="eqnarray2"><span 
class="cmsy-10"><span 
class="underline">&gt;</span></span></td><td 
align="left"nowrap 
class="eqnarray3">0</td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(22)<a 
   name="1-7008r23"></a></td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="cmsy-10">&gt; </span>+ <span 
class="emmi-10">c <img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sub ><span 
class="emmi-7">A</span></sub></td>    <td 
align="center"nowrap 
class="eqnarray2"><span 
class="cmsy-10"><span 
class="underline">&lt;</span></span></td><td 
align="left"nowrap 
class="eqnarray3"><span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub></td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(23)<a 
   name="1-7008r24"></a></td></tr>
<tr valign="middle" class="eqnarray"><td 
align="right"nowrap 
class="eqnarray1"><span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">E</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="cmsy-10">&gt; - </span><span 
class="emmi-10">c <img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sub ><span 
class="emmi-7">E,A</span></sub></td><td 
align="center"nowrap 
class="eqnarray2"><span 
class="cmsy-10"><span 
class="underline">&gt;</span></span></td><td 
align="left"nowrap 
class="eqnarray3">0</td><td 
width="10" class="eqnarray4"></td><td 
align="right"nowrap 
class="eqnarray4">(24)<a 
   name="1-7008r25"></a></td></tr></table>
</div>where <span 
class="emmi-10">c </span><span 
class="cmsy-10"><span 
class="underline">&gt;</span> </span>4. From the equations (<a 
 href="#1-7001r13">13</a>), (<a 
 href="#1-7004r16">16</a>) and (<a 
 href="#1-7005r18">18</a>) and from the conditions (<a 
 href="#1-7008r22">22</a>)
and (<a 
 href="#1-7008r23">23</a>) the following limits can be derived: <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa39x.gif"alt="      (n3 + c2)(Emax + I)              (n3 + c2)(Emax +I)
amin =---------------2- &lt; a  &lt; amax = -2---------------
       n3(Emax + I)+ c I               c(Emax + I)+ n3I"class="mathdisplay"><a 
   name="1-7009r25"></a></center></td><td width="5%">(25)</td></tr></table>
This conditions gives a lower limit to number of the ionisations <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub> for which the fast
sampling can be done: <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa40x.gif"alt="n3  &gt; c2"class="mathdisplay"><a 
   name="1-7010r26"></a></center></td><td width="5%">(26)</td></tr></table>
As in the conditions (<a 
 href="#1-7008r22">22</a>), (<a 
 href="#1-7008r23">23</a>) and (<a 
 href="#1-7008r24">24</a>) the value of <span 
class="emmi-10">c </span>is as minimum 4, one gets
<span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub>  <span 
class="cmsy-10"><span 
class="underline">&gt;</span> </span>16. In order to speed the simulation, the maximum value is used for
<span 
class="emmi-10"><img 
src="emmi10-b.gif"alt="a"class="10--b"></span>.
<!--469--><p class="indent">   The number of collisions with energy loss in the interval B (the number of
interactions which has to be simulated directly) increases slowly with the total
number of collisions <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub>. The maximum number of these collisions can be estimated
as <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa41x.gif"alt="nB,max = n3 -nA,min  ~~  n3(&lt;nA&gt; - sA)"class="mathdisplay"><a 
   name="1-7011r27"></a></center></td><td width="5%">(27)</td></tr></table>
From the previous expressions for <span 
class="cmsy-10">&lt;</span><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">A</span></sub><span 
class="cmsy-10">&gt; </span>and <span 
class="emmi-10"><img 
src="emmi10-1b.gif"alt="s"class="10--1b"></span><sub ><span 
class="emmi-7">A</span></sub> one can derive the condition
<table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa42x.gif"alt="              -2n3c2-
nB &lt;  nB,max = n3 + c2"class="mathdisplay"><a 
   name="1-7012r28"></a></center></td><td width="5%">(28)</td></tr></table>
The following values are obtained with <span 
class="emmi-10">c </span>= 4:
   <div align="center"><table class="tabular" 
cellspacing="0pt" cellpadding="0"  
frame="void" ><colgroup><col 
id="TBL-6-1"><col 
id="TBL-6-2"><col 
id="TBL-6-3"><col 
id="TBL-6-4"><col 
id="TBL-6-5"></colgroup><tr  
valign="baseline" id="TBL-6-1-"><td  align="left"nowrap id="TBL-6-1-1"  
><div class="td11"><span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub>  </div></td><td  align="left"nowrap id="TBL-6-1-2"  
><div class="td11"><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">B,max</span></sub></div></td><td  align="center"nowrap id="TBL-6-1-3"  
><div class="td11"></div></td><td  align="right"nowrap id="TBL-6-1-4"  
><div class="td11">   <span 
class="emmi-10">n</span><sub ><span 
class="emr-7">3</span></sub></div></td><td  align="right"nowrap id="TBL-6-1-5"  
><div class="td11"><span 
class="emmi-10">n</span><sub ><span 
class="emmi-7">B,max</span></sub></div></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
valign="baseline" id="TBL-6-2-"><td  align="left"nowrap id="TBL-6-2-1"  
><div class="td11">16  </div></td><td  align="left"nowrap id="TBL-6-2-2"  
><div class="td11">16      </div></td><td  align="center"nowrap id="TBL-6-2-3"  
><div class="td11"></div></td><td  align="right"nowrap id="TBL-6-2-4"  
><div class="td11">  200</div></td><td  align="right"nowrap id="TBL-6-2-5"  
><div class="td11">   29.63</div></td>
</tr><tr  
valign="baseline" id="TBL-6-3-"><td  align="left"nowrap id="TBL-6-3-1"  
><div class="td11">20  </div></td><td  align="left"nowrap id="TBL-6-3-2"  
><div class="td11">17.78   </div></td><td  align="center"nowrap id="TBL-6-3-3"  
><div class="td11"></div></td><td  align="right"nowrap id="TBL-6-3-4"  
><div class="td11">  500</div></td><td  align="right"nowrap id="TBL-6-3-5"  
><div class="td11">   31.01</div></td>
</tr><tr  
valign="baseline" id="TBL-6-4-"><td  align="left"nowrap id="TBL-6-4-1"  
><div class="td11">50  </div></td><td  align="left"nowrap id="TBL-6-4-2"  
><div class="td11">24.24   </div></td><td  align="center"nowrap id="TBL-6-4-3"  
><div class="td11"></div></td><td  align="right"nowrap id="TBL-6-4-4"  
><div class="td11">1000</div></td><td  align="right"nowrap id="TBL-6-4-5"  
><div class="td11">   31.50</div></td>
</tr><tr  
valign="baseline" id="TBL-6-5-"><td  align="left"nowrap id="TBL-6-5-1"  
><div class="td11">100</div></td><td  align="left"nowrap id="TBL-6-5-2"  
><div class="td11">27.59   </div></td><td  align="center"nowrap id="TBL-6-5-3"  
><div class="td11"></div></td><td  align="right"nowrap id="TBL-6-5-4"  
><div class="td11">   <span 
class="cmsy-10"><img 
src="cmsy10-31.gif"alt=" oo "class="10--31"></span></div></td><td  align="right"nowrap id="TBL-6-5-5"  
><div class="td11">   32.00</div></td> </tr></table>
</div>
   <h3 class="subsectionHead">5.2 <a 
   name="1-80005.2"></a><a 
   name="QQ1-1-10"></a>Special sampling for lower part of the spectrum</h3>
<!--494--><p class="noindent">If the step length is very small (<span 
class="cmsy-10"><span 
class="underline">&lt;</span> </span>5 mm in gases, <span 
class="cmsy-10"><span 
class="underline">&lt;</span> </span>2-3 <span 
class="emmi-10"><img 
src="emmi10-16.gif"alt="m"class="emmi-10--16"align="middle"></span>m in solids) the model gives
0 energy loss for some events. To avoid this, the probability of 0 energy loss is
computed <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa43x.gif"alt="             -(&lt;n &gt;+&lt;n &gt;+&lt;n &gt;)
P(  E = 0) = e  1   2   3"class="mathdisplay"><a 
   name="1-8001r29"></a></center></td><td width="5%">(29)</td></tr></table>
If the probability is bigger than 0.01 a special sampling is done, taking into
account the fact that in these cases the projectile interacts only with the outer
electrons of the atom. An energy level <span 
class="emmi-10">E</span><sub ><span 
class="emr-7">0</span></sub> = 10 eV is chosen to correspond to
the outer electrons. The mean number of collisions can be calculated from
<table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa44x.gif"alt="      1 dE
&lt;n&gt; = -----  x
      E0 dx"class="mathdisplay"><a 
   name="1-8002r30"></a></center></td><td width="5%">(30)</td></tr></table>
The number of collisions <span 
class="emmi-10">n </span>is sampled from Poisson distribution. In the case of the
thin layers, all the collisions are considered as ionisations and the energy loss is
computed as <table width="100%" 
class="equation"><tr><td>
   <center>
<img 
src="latexexa45x.gif"alt="     n
     sum  -----E0------
E =    1 - EEmax+E-ui
    i=1     max  0"class="mathdisplay"><a 
   name="1-8003r31"></a></center></td><td width="5%">(31)</td></tr></table>
   <h2 class="likesectionHead"><a 
   name="1-9000"></a><a 
   name="QQ1-1-11"></a>References</h2>
   <div class="thebibliography"><p class="bibitem">
 [1]   <a 
   name="Xbib-LAND"></a>L.Landau. On the Energy Loss of Fast Particles by Ionisation. Originally
   published  in  <span 
class="emti-10">J.  Phys.</span>,  8:201,  1944.    Reprinted  in  D.ter  Haar,  Editor,
   <span 
class="emti-10">L.D.Landau, Collected papers </span>, page 417. Pergamon Press, Oxford, 1965.
   </p><p class="bibitem">
 [2]   <a 
   name="Xbib-SCH1"></a>B.Schorr.  Programs for the Landau and the Vavilov distributions and
   the corresponding random numbers. <span 
class="emti-10">Comp. Phys. Comm.</span>, 7:216, 1974.
   </p><p class="bibitem">
 [3]   <a 
   name="Xbib-SELT"></a>S.M.Seltzer  and  M.J.Berger.   Energy  loss  straggling  of  protons  and
   mesons. In <span 
class="emti-10">Studies in Penetration of Charged Particles in Matter </span>, Nuclear
   Science Series 39, Nat. Academy of Sciences, Washington DC, 1964.
   </p><p class="bibitem">
 [4]   <a 
   name="Xbib-TALM"></a>R.Talman.  On the statistics of particle identification using ionization.
   <span 
class="emti-10">Nucl. Inst. Meth.</span>, 159:189, 1979.
   </p><p class="bibitem">
 [5]   <a 
   name="Xbib-VAVI"></a>P.V.Vavilov.  Ionisation losses of high energy heavy particles.  <span 
class="emti-10">Soviet</span>
   <span 
class="emti-10">Physics JETP </span>, 5:749, 1957.</p></div>
    
</body> 
</html>

